---
title: "Quick analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Analysis of RAPM model

This is a step by step analysis of the RAPM model. The key effect to prove is a correlation between the D2 parameter and the model's performance.

We begin by defining where the data is coming from

```{r}
file <- "test.csv"
vars <- c("D2", "Ticks", "Alpha", "EGS", "Accuracy",
          "ProblemRT", "ChoiceRT")
```

We now load the data and aggregate over it.

```{r}
sims <- read.csv(file)
names(sims) <- vars
sims <- subset(sims, is.numeric(sims$ProblemRT))
sub <- aggregate(sims[c("Accuracy", "ProblemRT", "ChoiceRT")], list(Alpha = sims$Alpha, s=sims$EGS, D2=sims$D2, Ticks=sims$Ticks), mean)
```

## Main effect 

The main effect is to test for a correlation between D2 and accuracy. The correlation is _r_ = ```r cor(sub$D2, sub$Accuracy)```

```{r}
ss <- subset(sub, sub$Ticks > 20)
plot(ss$D2, ss$Accuracy, ylim=c(0,1))
if (length((unique(ss$D2))) > 1) {
  model <- lm(ss$Accuracy ~ ss$D2)
  coeff <- model$coefficients
  abline(a=coeff[1], b=coeff[2], lwd=2, lty=2)
}
```

In contrast, we expect a correlation with Ticks: in this case, _r_ = ```r cor(sub$Ticks, sub$Accuracy)```.

```{r}
plot(sub$Ticks, sub$Accuracy, ylim=c(0,1))
if (length((unique(sub$Ticks))) > 1) {
  model <- lm(sub$Accuracy ~ sub$Ticks)
  coeff <- model$coefficients
  abline(a=coeff[1], b=coeff[2], lwd=2, lty=2)
}
```

And, of course, Ticks should correlate with RTs: _r_ = ```r cor(sub$Ticks, sub$ProblemRT)```

```r max(sub$ProblemRT)```

```{r}
maxrt <- 10 * ceiling(max(sub$ProblemRT)/10)
plot(sub$Ticks, sub$ProblemRT, ylim=c(0, maxrt))
if (length((unique(sub$Ticks))) > 1) {
  model <- lm(sub$ProblemRT ~ sub$Ticks)
  coeff <- model$coefficients
  abline(a=coeff[1], b=coeff[2], lwd=2, lty=2)
}
```
